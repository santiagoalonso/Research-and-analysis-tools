function B=inpaint_nans(trajectory, method)% INPAINT_NANS: in-paints over nans in an array by interpolation%Input%trajectory: nx3 matrix. Each column is an axis, each row is a sample from%            the recording device. In mm.%method: string for interp1 function. Values: 'nearest', 'next', 'previous', %        'linear','spline','pchip', or 'cubic'%Output%B: trajectory with interpolated NaNsNaNs = isnan(trajectory(:,1)); B = trajectory;if sum(NaNs)>0 %Only interpolates if there are NaNs    x = find(~NaNs); %available time points    v = B(x,:);    xq = find(NaNs); %query time points to interpolate    vq_coord1 = interp1(x,v(:,1),xq, method); %values at query points    vq_coord2 = interp1(x,v(:,2),xq, method);    vq_coord3 = interp1(x,v(:,3),xq, method);    B(xq,1) = vq_coord1;    B(xq,2) = vq_coord2;    B(xq,3) = vq_coord3;endend